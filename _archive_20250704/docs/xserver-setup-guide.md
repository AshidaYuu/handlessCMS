# 🌐 Xserver設定完全ガイド

## 📋 前提条件

- Xserverアカウント（スタンダードプラン推奨）
- 独自ドメイン（オプション）
- GitHub Actionsの基本理解

## 🔧 Step 1: Xserver FTP情報の取得

### 1. Xserverサーバーパネルにログイン

```
URL: https://www.xserver.ne.jp/login_server.php
```

**画面説明**:
```
┌─────────────────────────────────────┐
│        Xserverサーバーパネル          │
├─────────────────────────────────────┤
│ サーバーID: [your-server-id]        │
│ パスワード: [your-password]          │
│ ┌─────────┐                        │
│ │ ログイン │                        │
│ └─────────┘                        │
└─────────────────────────────────────┘
```

### 2. FTP情報の確認

**操作手順**:
1. サーバーパネルにログイン後
2. 「アカウント」セクションを確認
3. 「FTPアカウント設定」をクリック

**表示される情報**:
```
FTPサーバー名(ホスト名): sv*****.xserver.jp
ユーザー名: your-server-id
パスワード: サーバーパスワード
```

**重要な注意点**:
- FTPサーバー名: `sv12345.xserver.jp` 形式
- ユーザー名: サーバーIDと同じ
- パスワード: サーバーパネルのパスワード

### 3. 公開フォルダの確認

**デフォルト設定**:
```
公開フォルダ: /home/サーバーID/ドメイン名/public_html/
```

**ファイルマネージャーでの確認方法**:
1. サーバーパネル → 「ファイル管理」
2. ドメイン選択
3. `public_html` フォルダが公開ディレクトリ

## 🔐 Step 2: GitHub Secretsの設定

### GitHub リポジトリでの設定

**操作手順**:
1. GitHub リポジトリ → 「Settings」
2. 左メニュー → 「Secrets and variables」 → 「Actions」
3. 「New repository secret」をクリック

### 設定するSecrets

#### 1. FTP_SERVER
```
名前: FTP_SERVER
値: sv*****.xserver.jp
```

#### 2. FTP_USERNAME
```
名前: FTP_USERNAME
値: your-server-id
```

#### 3. FTP_PASSWORD
```
名前: FTP_PASSWORD
値: your-server-password
```

#### 4. FTP_SERVER_DIR
```
名前: FTP_SERVER_DIR
値: /your-domain.com/public_html/
```

**注意**: `your-domain.com` は実際のドメイン名に置き換え

## 🌍 Step 3: ドメイン設定

### 1. ドメインの追加（新規ドメインの場合）

**操作手順**:
1. サーバーパネル → 「ドメイン設定」
2. 「ドメイン設定追加」タブ
3. ドメイン名を入力
4. 「確認画面へ進む」

**表示画面イメージ**:
```
┌─────────────────────────────────────┐
│           ドメイン設定追加            │
├─────────────────────────────────────┤
│ ドメイン名: [example.com          ] │
│                                     │
│ ☑ 無料独自SSLを利用する              │
│ ☑ 高速化・アクセス数拡張機能を有効    │
│                                     │
│ ┌─────────────┐                     │
│ │ 確認画面へ進む │                     │
│ └─────────────┘                     │
└─────────────────────────────────────┘
```

### 2. DNS設定の確認

**必要な設定**:
```
Aレコード:
名前: @（または空欄）
値: XserverのサーバーIP

CNAMEレコード:
名前: www
値: your-domain.com
```

**確認方法**:
```bash
# DNSの浸透確認
nslookup your-domain.com
dig your-domain.com
```

## 🔒 Step 4: SSL証明書設定

### 1. 無料独自SSL設定

**操作手順**:
1. サーバーパネル → 「SSL設定」
2. 対象ドメインを選択
3. 「独自SSL設定追加」タブ
4. 「確認画面へ進む」

**設定画面イメージ**:
```
┌─────────────────────────────────────┐
│           SSL設定追加                │
├─────────────────────────────────────┤
│ サイト: example.com                 │
│ ☑ CSR情報(SSL証明書申請情報)を入力   │
│                                     │
│ 国名: JP                           │
│ 都道府県: Tokyo                     │
│ 市区町村: Shibuya                   │
│ 組織名: Your Company               │
│                                     │
│ ┌─────────────┐                     │
│ │ 確認画面へ進む │                     │
│ └─────────────┘                     │
└─────────────────────────────────────┘
```

### 2. SSL証明書の反映確認

**確認方法**:
- 設定後、1時間程度で反映
- `https://your-domain.com` でアクセス確認
- ブラウザのアドレスバーに🔒マークが表示

**よくあるエラー**:
```
× SSL設定に失敗しました
→ ドメインのDNS設定を確認
→ 24時間後に再試行

× 証明書が無効です
→ ドメインの向き先を確認
→ サブドメインの設定確認
```

## 📁 Step 5: ファイル構造の準備

### 推奨ディレクトリ構造

```
/home/サーバーID/your-domain.com/public_html/
├── index.html              # トップページ
├── posts/                  # 投稿ページ
│   └── [slug]/
│       └── index.html
├── _next/                  # Next.jsのビルドファイル
├── assets/                 # 静的ファイル
├── .htaccess              # サーバー設定
└── sitemap.xml            # SEO用サイトマップ
```

### テスト用HTMLファイルの作成

**操作手順**:
1. ファイルマネージャーでpublic_htmlにアクセス
2. 「ファイル作成」で `test.html` を作成
3. 以下の内容を入力:

```html
<!DOCTYPE html>
<html>
<head>
    <title>Test Page</title>
</head>
<body>
    <h1>Xserver Connection Test</h1>
    <p>このページが表示されれば設定成功です！</p>
</body>
</html>
```

4. `https://your-domain.com/test.html` でアクセス確認

## 🔍 トラブルシューティング

### よくある問題と解決法

#### 1. FTP接続できない
```
エラー: Connection refused
解決法:
- FTPサーバー名の確認
- ポート番号: 21（デフォルト）
- パッシブモードの使用
```

#### 2. ファイルアップロードできない
```
エラー: Permission denied
解決法:
- 権限設定の確認（755推奨）
- ディレクトリの存在確認
- 容量制限の確認
```

#### 3. SSL証明書エラー
```
エラー: Certificate invalid
解決法:
- DNS設定の確認
- 反映時間の待機（最大24時間）
- サブドメインの設定確認
```

#### 4. ドメインアクセスできない
```
エラー: Site not found
解決法:
- DNS設定の確認
- ネームサーバーの設定
- 反映時間の待機
```

## 📊 設定確認チェックリスト

### 必須項目
- [ ] Xserverアカウント作成完了
- [ ] FTP情報取得完了
- [ ] GitHub Secrets設定完了
- [ ] ドメイン設定完了
- [ ] SSL証明書設定完了

### オプション項目
- [ ] 独自ドメイン取得
- [ ] サブドメイン設定
- [ ] メール設定
- [ ] データベース設定（将来用）

---

## 🚀 次のステップ

設定が完了したら、以下の情報を確認してください：

1. **FTPサーバー**: `sv*****.xserver.jp`
2. **ユーザー名**: `your-server-id`
3. **パスワード**: `your-password`
4. **公開ディレクトリ**: `/your-domain.com/public_html/`
5. **ドメイン**: `https://your-domain.com`

これらの情報が揃ったら、GitHub Actionsの設定に進めます！